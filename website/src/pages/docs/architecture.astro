---
import DocsLayout from '../../layouts/DocsLayout.astro';
---

<DocsLayout title="Architecture Overview" description="How Smith's multi-agent system works">
  <div class="docs-header">
    <h1>Architecture Overview</h1>
    <p class="lead">A brief overview of how Smith coordinates multiple AI agents to build software.</p>
  </div>

  <div class="content">
    <section class="docs-section">
      <h2 id="how-it-works">How It Works</h2>
      <p>Smith uses a coordinator agent that delegates work to specialized background agents. You chat with the coordinator in the REPL, while background agents work on planning, coding, testing, and reviewing your features.</p>

      <div class="simple-diagram">
        <div class="flow-step">
          <div class="step-icon">üí¨</div>
          <div class="step-content">
            <h3>You chat with Smith</h3>
            <p>Request features in natural language</p>
          </div>
        </div>

        <div class="flow-arrow">‚Üì</div>

        <div class="flow-step">
          <div class="step-icon">üï∂Ô∏è</div>
          <div class="step-content">
            <h3>Coordinator breaks it down</h3>
            <p>Analyzes request and creates tasks</p>
          </div>
        </div>

        <div class="flow-arrow">‚Üì</div>

        <div class="flow-step">
          <div class="step-icon">‚ö°</div>
          <div class="step-content">
            <h3>Agents work in parallel</h3>
            <p>Planning, coding, testing happen concurrently</p>
          </div>
        </div>

        <div class="flow-arrow">‚Üì</div>

        <div class="flow-step">
          <div class="step-icon">‚úÖ</div>
          <div class="step-content">
            <h3>Results integrated</h3>
            <p>Code written, tests passing, ready to commit</p>
          </div>
        </div>
      </div>
    </section>

    <section class="docs-section">
      <h2 id="key-components">Key Components</h2>
      
      <div class="component-grid">
        <div class="comp-card">
          <h3>üéØ REPL</h3>
          <p>Interactive terminal interface where you chat with Smith and see agent progress in real-time.</p>
        </div>

        <div class="comp-card">
          <h3>üï∂Ô∏è Coordinator</h3>
          <p>Main agent that talks to you, breaks down requests, and manages other agents.</p>
        </div>

        <div class="comp-card">
          <h3>ü§ñ Background Agents</h3>
          <p>Specialized agents (planning, implementation, testing, review) that work autonomously.</p>
        </div>

        <div class="comp-card">
          <h3>üìã Task Queue</h3>
          <p>BBolt-based queue that coordinates work between agents safely.</p>
        </div>

        <div class="comp-card">
          <h3>üõ†Ô∏è Tools</h3>
          <p>File operations, command execution, Git integration - agents use these to build software.</p>
        </div>

        <div class="comp-card">
          <h3>üîí Safety System</h3>
          <p>Controls what agents can do automatically vs. what requires your approval.</p>
        </div>
      </div>
    </section>

    <section class="docs-section">
      <h2 id="why-multi-agent">Why Multiple Agents?</h2>
      
      <div class="benefit-list">
        <div class="benefit">
          <div class="benefit-icon">‚ö°</div>
          <div>
            <h3>Parallel Execution</h3>
            <p>Planning can happen while tests are being written. Multiple tasks progress simultaneously instead of sequentially.</p>
          </div>
        </div>

        <div class="benefit">
          <div class="benefit-icon">üéØ</div>
          <div>
            <h3>Specialized Focus</h3>
            <p>Each agent has a specific role with tailored prompts and tools, leading to higher quality output than a single generalist agent.</p>
          </div>
        </div>

        <div class="benefit">
          <div class="benefit-icon">üîÑ</div>
          <div>
            <h3>Natural Workflow</h3>
            <p>Mirrors how dev teams work - planning, implementation, testing, and review happen as distinct activities.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="docs-section">
      <h2 id="technical-stack">Technical Stack</h2>
      <ul>
        <li><strong>Language:</strong> Go - for performance, concurrency, and single binary distribution</li>
        <li><strong>Storage:</strong> BBolt - embedded key-value store for reliable, lock-free concurrent coordination</li>
        <li><strong>UI:</strong> Lotus - blazing fast terminal interface</li>
        <li><strong>LLM Providers:</strong> GitHub Copilot, OpenRouter - flexible model choices</li>
      </ul>
    </section>

    <section class="docs-section">
      <h2 id="learn-more">Learn More</h2>
      <p>For detailed technical information about Smith's internals, package structure, and design decisions, check out:</p>
      <ul>
        <li><a href="https://github.com/speier/smith" target="_blank" rel="noopener">GitHub Repository</a> - Source code and detailed README</li>
        <li><a href="https://github.com/speier/smith/tree/main/internal" target="_blank" rel="noopener">Internal Packages</a> - Package-level documentation</li>
      </ul>
    </section>
  </div>
</DocsLayout>

<style>
  /* Color variables inherited from DocsLayout */

  .docs-header {
    margin-bottom: 3rem;
    padding-bottom: 2rem;
    border-bottom: 1px solid var(--color-border);
  }

  .docs-header h1 {
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: 1rem;
    background: linear-gradient(135deg, var(--color-primary) 0%, #00ccff 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .lead {
    font-size: 1.25rem;
    color: var(--color-text-secondary);
    line-height: 1.6;
  }

  .content {
    display: flex;
    flex-direction: column;
    gap: 3rem;
  }

  .docs-section h2 {
    font-size: 1.75rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
    color: var(--color-text);
    scroll-margin-top: 100px;
  }

  .docs-section h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 1.5rem 0 1rem;
    color: var(--color-text);
  }

  .docs-section p {
    margin-bottom: 1rem;
    color: var(--color-text-secondary);
    line-height: 1.8;
  }

  .docs-section ul {
    margin: 1rem 0 1.5rem 1.5rem;
    color: var(--color-text-secondary);
    line-height: 1.8;
  }

  .docs-section li {
    margin-bottom: 0.5rem;
  }

  .docs-section a {
    color: var(--color-primary);
    text-decoration: none;
  }

  .docs-section a:hover {
    text-decoration: underline;
  }

  code {
    font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
    font-size: 0.9rem;
    background: var(--color-surface);
    padding: 0.2rem 0.4rem;
    border-radius: 4px;
    color: var(--color-primary);
  }

  /* Simple Flow Diagram */
  .simple-diagram {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 2rem;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 12px;
    margin: 2rem 0;
  }

  .flow-step {
    display: flex;
    gap: 1.5rem;
    align-items: flex-start;
  }

  .step-icon {
    font-size: 2.5rem;
    flex-shrink: 0;
    width: 3rem;
    text-align: center;
  }

  .step-content h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    color: var(--color-text);
  }

  .step-content p {
    margin: 0;
    font-size: 0.95rem;
    color: var(--color-text-secondary);
  }

  .flow-arrow {
    text-align: center;
    font-size: 1.5rem;
    color: var(--color-primary);
    padding: 0.5rem 0;
  }

  /* Component Grid */
  .component-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin: 2rem 0;
  }

  .comp-card {
    padding: 1.5rem;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 8px;
    transition: all 0.2s;
  }

  .comp-card:hover {
    border-color: var(--color-primary);
    transform: translateY(-2px);
  }

  .comp-card h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1.1rem;
    color: var(--color-text);
  }

  .comp-card p {
    margin: 0;
    font-size: 0.9rem;
    color: var(--color-text-secondary);
  }

  /* Benefit List */
  .benefit-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    margin: 2rem 0;
  }

  .benefit {
    display: flex;
    gap: 1.5rem;
    padding: 1.5rem;
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-left: 3px solid var(--color-primary);
    border-radius: 8px;
  }

  .benefit-icon {
    font-size: 2rem;
    flex-shrink: 0;
  }

  .benefit h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    color: var(--color-text);
  }

  .benefit p {
    margin: 0;
    font-size: 0.95rem;
    color: var(--color-text-secondary);
  }
</style>
